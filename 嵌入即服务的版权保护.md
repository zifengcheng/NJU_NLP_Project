# 嵌入即服务的版权保护

本次大作业是针对大语言模型（LLM）提供的Embedding as a Service (EaaS)的版权保护。具体方法是借助预定义的水印向量，嵌入到现有嵌入中，实现水印植入的效果。在复现完现有实验以后，对实验结果进行分析，同时进一步探索现有方法的缺陷。

---
## 一、背景要求

大型语言模型（LLM）在文本理解和生成方面都表现出了强大的能力。很多公司已经开始提供基于这些LLM的嵌入即服务（EaaS），这可以为客户处理各种自然语言处理（NLP）任务提供便利。然而，之前的研究表明，EaaS容易受到模型提取攻击，（即攻击者利用从目标模型中查询到的嵌入训练一个类似的模型，提供相同的服务），这可能会给LLM的所有者带来重大损失，因为训练这些模型非常昂贵。因此，对这些LLM的嵌入即服务进行版权保护是必要的。

---

## 二、基于后门水印的嵌入版权保护方法介绍


目前最经典的嵌入版权保护的方法EmbMarker是选取一组中等频率的单词作为触发器单词集合，一个水印嵌入，在输入文本包含触发器单词的情况下，将水印嵌入使用加权的方式嵌入到输入文本的嵌入中，从而实现植入后门水印。攻击者使用这些植入后门水印的嵌入训练得到的盗取模型也会被植入后门水印，具体表现为，盗取模型面对包含触发器单词的文本输出的嵌入会在一定程度上接近水印嵌入，防御者可以利用这一点进行水印检测。

更多信息可以参考论文：Are You Copying My Model? Protecting the Copyright of Large Language Models for EaaS via Backdoor Watermark。除此以外，还有更多关于嵌入版权保护的论文也可以参考。



## 三、任务描述

本次实验采用 **SST2 Dataset**，作业任务分为两个任务，内容如下：

### 3.1 简单任务（40分 = 结果准确性30分 + 报告质量10分）

- **任务内容**：
- **复现EmbMarker代码**：使用cos相似度的差异、L2距离的平方差以及p-value实现水印检测。
- **嵌入的可视化**：使用PCA或者t-SNE对EmbMarker提供的嵌入进行可视化。

- [EmbMarker代码链接](https://github.com/yjw1029/EmbMarker)

### 3.2 分析任务 （20分 = 创新性10分 + 报告质量10分）

请完成下面两项任务：
1. 探索触发器单词集合的大小对实验结果的影响，主要是两方面，即模型分类准确率和水印检测效果。
2. 探索触发器单词频率的大小对实验结果的影响，也是两方面，即模型分类准确率和水印检测效果。


### 3.3 进阶任务 （40分 = 创新性20分 + 报告质量20分）

请从下面两个任务中选择一个完成：

1. 攻击方面。设计并实现一种触发器单词检测方法来进行攻击。EmbMarker依赖一组触发器单词，设计的检测方法需要能推断出触发器单词的存在，甚至定位到具体的触发器单词。最后，通过实验展示可以识别多少个触发器单词。

2. 防御方面，设计一种更先进的防御策略并叙述该防御方法为何更先进。比如释义攻击（paraphrase attack）可以清洗掉触发器单词，导致防御策略失效。是否可以设计一种不依赖触发器单词的防御方法。


注意，算法设计必须为原创，严禁抄袭已有论文方法。


---

## 四、提交要求

提交内容包括：

1. **完整代码文件**：将所有代码文件打包提交，包含复现EmbMarker嵌入版权保护的代码以及进阶任务的代码。
    
2. **实验报告（PDF）**
    
## 五、注意事项

1. **参考文献**：
    
    - 如果你在实验和报告中参考了已发表的文献，请列出你所参考的相关文献。
2. [数据](https://box.nju.edu.cn/d/e6085374407748809992/)可以从上面的链接下载。
    
3. 如有疑问，请联系 chengzf@smail.nju.edu.cn。
